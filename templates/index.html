<!-- templates/index.html -->
<!DOCTYPE html>
<html>
<head>
  <title>üìã Action Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #fafafa;
    }

    h2, h3 {
      margin-bottom: 10px;
    }

    label {
      font-weight: bold;
    }

    form {
      margin-bottom: 15px;
    }

    button {
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 6px 12px;
      margin-left: 10px;
      cursor: pointer;
      border-radius: 4px;
    }

    button:hover {
      background-color: #45a049;
    }

    .date-buttons button {
      background-color: #f0f0f0;
      color: #333;
      border: 1px solid #ccc;
      margin: 2px;
      padding: 4px 8px;
    }

    .date-buttons button:hover {
      background-color: #ddd;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      background-color: white;
    }

    th, td {
      padding: 10px;
      border: 1px solid #ddd;
      text-align: left;
      vertical-align: top;
    }

    tr:nth-child(even) {
      background-color: #f9f9f9;
    }

    tr.executed {
      background-color: #e6ffe6;
    }

    .actions a {
      margin: 0 5px;
      text-decoration: none;
    }

    .actions a:hover {
      text-decoration: underline;
    }

    .type-inputs {
      margin-top: 10px;
    }

    .type-inputs label {
      display: inline-block;
      margin-right: 10px;
    }

    /* New: keep the toggle form inline like the links */
    .actions form {
      display: inline;
      margin: 0;
      padding: 0;
    }

    .toggle-btn {
      background: #1976d2;
      padding: 4px 8px;
      border-radius: 4px;
      margin-right: 6px;
    }
    .toggle-btn.pending { background: #1976d2; }
    .toggle-btn.executed { background: #9e9e9e; }
  </style>
</head>
<body>

  <h2>üìÖ Action Plan for {{ current_date }}</h2>

  <form method="post" action="{{ url_for('generate') }}">
    <label for="selected_date">Pick a date:</label>
    <input type="date" id="selected_date" name="selected_date" required>

    <div class="type-inputs">
      {% for type in ["create_comment", "send_dm", "like_post", "reply_comment", "follow", "reply_dm", "view_story"] %}
        <label>{{ type }}:
          <input type="number" name="{{ type }}" min="0" value="1" style="width: 50px;">
        </label>
      {% endfor %}
    </div>

    <button type="submit">üß† Generate Plan</button>
  </form>

  <p><a href="{{ url_for('create') }}">‚ûï Create New Action</a></p>

  <h3>üìÇ Existing Plans</h3>
  <div class="date-buttons">
    {% for date in existing_dates %}
      <form method="get" action="{{ url_for('view_plan_for_date', date=date) }}" style="display:inline;">
        <button type="submit">{{ date[5:] }}</button>
      </form>
    {% endfor %}
  </div>

  <table>
    <thead>
      <tr>
        <th>#</th>
        <th>Time</th>
        <th>Type</th>
        <th>Account</th>
        <th>Link</th>
        <th>Content</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for action in actions %}
      <tr class="{% if action.executed %}executed{% endif %}">
        <td>{{ loop.index }}</td>
        <td>{{ action.time }}</td>
        <td>{{ action.type }}</td>
        <td>{{ action.account }}</td>
        <td><a href="{{ action.link }}" target="_blank">üîó</a></td>
        <td>{{ action.content }}</td>
        <td>{% if action.executed %}‚úî Executed{% else %}‚è≥ Pending{% endif %}</td>
        <td class="actions">
          <!-- New: toggle executed/pending -->
          <form method="post"
                action="{{ url_for('toggle_executed', date=current_date, index=loop.index0) }}">
            {% if action.executed %}
              <button class="toggle-btn executed" type="submit" title="Set back to pending">‚úÖ Mark Pending</button>
            {% else %}
              <button class="toggle-btn pending" type="submit" title="Mark as executed">‚úîÔ∏è Mark Executed</button>
            {% endif %}
          </form>

          <a href="{{ url_for('edit', date=current_date, index=loop.index0) }}">‚úèÔ∏è Edit</a> |
          <a href="{{ url_for('delete', date=current_date, index=loop.index0) }}"
             onclick="return confirm('Delete this action?')">üóëÔ∏è Delete</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

</body>
</html>
